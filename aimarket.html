<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MacropolÂ°s | Neural Ops</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;600;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-deep: #030305;
            --panel-bg: #0a0a0c;
            --neon-cyan: #00f3ff;
            --neon-purple: #bc13fe;
            --neon-green: #0aff0a;
            --border-dim: rgba(255, 255, 255, 0.08);
        }

        body {
            background-color: var(--bg-deep);
            color: #e0e0e0;
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* App-like container */
        }

        .font-mono { font-family: 'JetBrains Mono', monospace; }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: var(--bg-deep); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

        /* --- Glass Panels --- */
        .glass-panel {
            background: rgba(10, 10, 12, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-dim);
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* --- Neural Graph Canvas --- */
        #neural-canvas {
            background: radial-gradient(circle at center, #111 0%, #000 100%);
        }

        /* --- Map Dots Animation --- */
        .map-dot {
            position: absolute;
            width: 6px; height: 6px;
            background-color: var(--neon-cyan);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--neon-cyan);
            animation: ping 2s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        @keyframes ping {
            75%, 100% { transform: scale(3); opacity: 0; }
        }

        /* --- Glitch Text --- */
        .glitch-text:hover {
            text-shadow: 2px 0 var(--neon-purple), -2px 0 var(--neon-cyan);
        }

        /* --- Mobile Tab Active State --- */
        .tab-active {
            border-bottom: 2px solid var(--neon-cyan);
            color: white;
            background: linear-gradient(to top, rgba(0, 243, 255, 0.1), transparent);
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyan: '#00f3ff',
                        purple: '#bc13fe',
                        dark: '#030305'
                    }
                }
            }
        }
    </script>
</head>
<body class="h-screen w-screen flex flex-col">

    <!-- TOP BAR -->
    <header class="h-14 border-b border-white/10 flex items-center justify-between px-4 bg-dark/90 backdrop-blur z-50 shrink-0">
        <div class="flex items-center gap-2">
            <i data-lucide="cpu" class="text-cyan w-5 h-5"></i>
            <span class="font-bold tracking-widest text-sm">NEURAL<span class="text-cyan">OPS</span></span>
        </div>
        <div class="flex items-center gap-4 text-xs font-mono text-gray-400">
            <span class="hidden md:inline">GPU: <span class="text-green-400">H100 x8 (Active)</span></span>
            <div class="px-2 py-1 border border-cyan/30 rounded text-cyan hover:bg-cyan/10 cursor-pointer transition">
                <i data-lucide="wallet" class="w-3 h-3 inline mr-1"></i> CONNECT
            </div>
        </div>
    </header>

    <!-- MAIN WORKSPACE (Grid) -->
    <main class="flex-1 relative grid grid-cols-1 lg:grid-cols-12 overflow-hidden">
        
        <!-- MOBILE TABS (Visible only on small screens) -->
        <div class="lg:hidden absolute top-0 left-0 w-full h-10 flex bg-dark border-b border-white/10 z-40">
            <button onclick="switchTab('visuals')" class="flex-1 text-xs font-bold text-gray-500 tab-active" id="tab-visuals">VISUALIZATION</button>
            <button onclick="switchTab('code')" class="flex-1 text-xs font-bold text-gray-500" id="tab-code">AGENTIC CODE</button>
            <button onclick="switchTab('controls')" class="flex-1 text-xs font-bold text-gray-500" id="tab-controls">CONTROLS</button>
        </div>

        <!-- LEFT COL: VISUALIZATION (Graph + Map) -->
        <div id="view-visuals" class="col-span-1 lg:col-span-5 flex flex-col h-full border-r border-white/10 relative pt-10 lg:pt-0">
            
            <!-- 1. Deep Graph (Neural Reasoning) -->
            <div class="h-1/2 relative border-b border-white/10 group">
                <div class="absolute top-2 left-2 z-10 flex items-center gap-2">
                    <span class="text-[10px] font-mono text-cyan bg-cyan/10 px-2 py-1 rounded border border-cyan/20">LIVE INFERENCE</span>
                    <span class="text-[10px] font-mono text-gray-400">G6 Topology</span>
                </div>
                <canvas id="neural-canvas" class="w-full h-full cursor-crosshair"></canvas>
            </div>

            <!-- 2. Geospatial Inference Map -->
            <div class="h-1/2 relative bg-[#050505] overflow-hidden">
                <div class="absolute top-2 left-2 z-10 text-[10px] font-mono text-purple-400 bg-purple-900/10 px-2 py-1 rounded border border-purple-500/20">GLOBAL NODES</div>
                
                <!-- Stylized World Map Background -->
                <div class="absolute inset-0 opacity-30" style="background-image: url('https://upload.wikimedia.org/wikipedia/commons/8/80/World_map_-_low_resolution.svg'); background-size: cover; background-position: center; filter: invert(1) hue-rotate(180deg);"></div>
                
                <!-- Interactive Dots -->
                <div class="map-dot" style="top: 30%; left: 25%"></div> <!-- US -->
                <div class="map-dot" style="top: 40%; left: 48%"></div> <!-- EU -->
                <div class="map-dot" style="top: 60%; left: 75%"></div> <!-- AUS -->
                <div class="map-dot" style="top: 35%; left: 80%"></div> <!-- JP -->

                <!-- Data Feed Overlay -->
                <div class="absolute bottom-0 left-0 w-full p-2 bg-gradient-to-t from-black to-transparent">
                    <div class="font-mono text-[9px] text-green-500 leading-tight">
                        > NODE_US_EAST: PROCESSING BATCH #9921<br>
                        > NODE_EU_WEST: LATENCY 12ms<br>
                        > SYNC: 100% COMPLETE
                    </div>
                </div>
            </div>
        </div>

        <!-- CENTER COL: AGENTIC CODE & TERMINAL -->
        <div id="view-code" class="hidden lg:flex col-span-1 lg:col-span-4 flex-col h-full border-r border-white/10 bg-[#0c0c0e] pt-10 lg:pt-0">
            <!-- Toolbar -->
            <div class="h-10 border-b border-white/5 flex items-center px-4 justify-between bg-[#111]">
                <div class="flex gap-2">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                </div>
                <div class="text-xs text-gray-500 font-mono">agent_core.py</div>
            </div>

            <!-- Code Editor -->
            <div class="flex-1 p-4 font-mono text-xs overflow-y-auto text-gray-300 leading-relaxed relative">
                <div class="absolute left-0 top-0 bottom-0 w-8 border-r border-white/5 text-right pr-2 text-gray-700 select-none pt-4">
                    1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12
                </div>
                <div class="pl-6">
<span class="text-purple-400">import</span> macropolos.ai <span class="text-purple-400">as</span> mai
<span class="text-purple-400">from</span> deepmind <span class="text-purple-400">import</span> GeminiAgent

<span class="text-gray-500"># Initialize Agentic Workflow</span>
agent = GeminiAgent(model=<span class="text-green-400">"gemini-1.5-pro-002"</span>)

<span class="text-cyan">@agent.optimize</span>
<span class="text-purple-400">def</span> <span class="text-yellow-400">predict_market_trend</span>(dataset):
    <span class="text-gray-500">"""
    Deep reasoning chain for trend analysis
    """</span>
    context = agent.ingest(dataset)
    reasoning = agent.chain_of_thought(context)
    
    <span class="text-purple-400">return</span> reasoning.generate_sql()

<span class="text-gray-500"># Real-time fine-tuning loop</span>
<span class="text-purple-400">while</span> <span class="text-cyan">True</span>:
    loss = agent.train_step()
    <span class="text-purple-400">if</span> loss < 0.01:
        agent.deploy()
                </div>
            </div>

            <!-- Live Terminal -->
            <div class="h-1/3 border-t border-white/10 bg-black p-2 font-mono text-[10px] text-gray-400 overflow-y-auto" id="terminal-output">
                <div class="text-green-500">> SYSTEM READY.</div>
                <div class="text-cyan">> LISTENING FOR DATASETS...</div>
            </div>
        </div>

        <!-- RIGHT COL: CONTROLS & DATASETS -->
        <div id="view-controls" class="hidden lg:flex col-span-1 lg:col-span-3 flex-col h-full bg-[#050505] pt-10 lg:pt-0">
            
            <!-- Dataset Ingestion (Kaggle Style) -->
            <div class="p-4 border-b border-white/10">
                <div class="text-xs font-bold text-gray-500 uppercase mb-3 flex items-center gap-2">
                    <i data-lucide="database" class="w-3 h-3"></i> Dataset Ingestion
                </div>
                <div id="drop-zone" class="border-2 border-dashed border-gray-700 rounded-lg p-6 text-center hover:border-cyan hover:bg-cyan/5 transition cursor-pointer group">
                    <i data-lucide="upload-cloud" class="w-8 h-8 text-gray-600 mx-auto mb-2 group-hover:text-cyan group-hover:animate-bounce"></i>
                    <p class="text-xs text-gray-400">Drag CSV/JSON or <span class="text-cyan underline">Browse</span></p>
                    <p class="text-[9px] text-gray-600 mt-1">Supports Vectors & Parquet</p>
                </div>
            </div>

            <!-- Finetuning Controls -->
            <div class="p-4 border-b border-white/10 flex-1 overflow-y-auto">
                <div class="text-xs font-bold text-gray-500 uppercase mb-4">Hyperparameters</div>

                <div class="mb-6">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-gray-400">Learning Rate</span>
                        <span class="text-cyan" id="lr-val">0.001</span>
                    </div>
                    <input type="range" min="0.0001" max="0.01" step="0.0001" value="0.001" class="w-full h-1 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-cyan" oninput="updateChart(this.value)">
                </div>

                <div class="mb-6">
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-gray-400">Epochs</span>
                        <span class="text-purple-400">150</span>
                    </div>
                    <input type="range" class="w-full h-1 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-purple-500">
                </div>

                <!-- Precision Chart -->
                <div class="bg-white/5 rounded-lg p-3">
                    <div class="text-[10px] text-gray-500 uppercase mb-2">Model Loss / Accuracy</div>
                    <canvas id="lossChart" height="150"></canvas>
                </div>

                <!-- Transformations List -->
                <div class="mt-6">
                    <div class="text-xs font-bold text-gray-500 uppercase mb-2">Transformations</div>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-2 bg-white/5 rounded text-xs">
                            <span class="text-gray-300">Vectorize</span>
                            <span class="text-green-500 text-[10px]">DONE</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-white/5 rounded text-xs">
                            <span class="text-gray-300">Normalize</span>
                            <span class="text-green-500 text-[10px]">DONE</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-white/5 rounded text-xs border border-cyan/20">
                            <span class="text-cyan">Attention Mechanism</span>
                            <div class="w-2 h-2 bg-cyan rounded-full animate-pulse"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Bar -->
            <div class="p-4 bg-dark border-t border-white/10">
                <button class="w-full bg-gradient-to-r from-purple-700 to-cyan/80 text-white font-mono font-bold py-3 rounded text-xs tracking-widest hover:brightness-110 transition shadow-[0_0_15px_rgba(188,19,254,0.3)]">
                    DEPLOY AGENT
                </button>
            </div>
        </div>

    </main>

    <script>
        lucide.createIcons();

        // --- 1. MOBILE TAB LOGIC ---
        function switchTab(tabName) {
            // Hide all views on mobile
            ['visuals', 'code', 'controls'].forEach(t => {
                document.getElementById('view-' + t).classList.remove('flex');
                document.getElementById('view-' + t).classList.add('hidden');
                // Remove active styling
                document.getElementById('tab-' + t).classList.remove('tab-active', 'text-white');
                document.getElementById('tab-' + t).classList.add('text-gray-500');
            });

            // Show selected view
            const selectedView = document.getElementById('view-' + tabName);
            selectedView.classList.remove('hidden');
            selectedView.classList.add('flex');
            
            // LG screen override: On large screens, grid handles visibility, but this logic helps simple toggling
            // Ideally, we reset classes for LG in CSS, but here's a JS fix:
            if(window.innerWidth >= 1024) {
                 document.getElementById('view-visuals').classList.remove('hidden');
                 document.getElementById('view-code').classList.remove('hidden');
                 document.getElementById('view-controls').classList.remove('hidden');
            }

            // Set active styling
            document.getElementById('tab-' + tabName).classList.add('tab-active', 'text-white');
            document.getElementById('tab-' + tabName).classList.remove('text-gray-500');
        }
        
        // Initial setup for mobile
        if(window.innerWidth < 1024) switchTab('visuals');


        // --- 2. DEEP GRAPH ENGINE (Custom G6-like Canvas) ---
        const canvas = document.getElementById('neural-canvas');
        const ctx = canvas.getContext('2d');
        let nodes = [];
        let connections = [];

        function resizeCanvas() {
            canvas.width = canvas.parentElement.offsetWidth;
            canvas.height = canvas.parentElement.offsetHeight;
            initGraph();
        }
        window.addEventListener('resize', resizeCanvas);

        function initGraph() {
            nodes = [];
            connections = [];
            const nodeCount = 40;
            
            // Create Nodes
            for(let i=0; i<nodeCount; i++) {
                nodes.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 0.5,
                    vy: (Math.random() - 0.5) * 0.5,
                    size: Math.random() * 2 + 1,
                    type: Math.random() > 0.8 ? 'processor' : 'neuron' // Special nodes
                });
            }
        }

        function drawGraph() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Update & Draw Nodes
            nodes.forEach((node, i) => {
                node.x += node.vx;
                node.y += node.vy;

                // Bounce
                if(node.x < 0 || node.x > canvas.width) node.vx *= -1;
                if(node.y < 0 || node.y > canvas.height) node.vy *= -1;

                // Draw Connections
                nodes.forEach((otherNode, j) => {
                    if(i === j) return;
                    const dx = node.x - otherNode.x;
                    const dy = node.y - otherNode.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);

                    if(dist < 100) {
                        ctx.beginPath();
                        ctx.strokeStyle = `rgba(0, 243, 255, ${1 - dist/100})`;
                        ctx.lineWidth = 0.5;
                        ctx.moveTo(node.x, node.y);
                        ctx.lineTo(otherNode.x, otherNode.y);
                        ctx.stroke();
                    }
                });

                // Draw Node
                ctx.beginPath();
                ctx.arc(node.x, node.y, node.size, 0, Math.PI * 2);
                ctx.fillStyle = node.type === 'processor' ? '#bc13fe' : '#ffffff';
                ctx.fill();
                
                // Glow for processors
                if(node.type === 'processor') {
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = '#bc13fe';
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }
            });

            requestAnimationFrame(drawGraph);
        }
        
        resizeCanvas();
        drawGraph();


        // --- 3. CHART.JS REAL-TIME FINE-TUNING ---
        const ctxChart = document.getElementById('lossChart').getContext('2d');
        const lossChart = new Chart(ctxChart, {
            type: 'line',
            data: {
                labels: Array.from({length: 20}, (_, i) => i),
                datasets: [{
                    label: 'Loss',
                    data: Array.from({length: 20}, () => Math.random() * 0.5),
                    borderColor: '#bc13fe',
                    borderWidth: 1,
                    tension: 0.4,
                    pointRadius: 0
                }, {
                    label: 'Accuracy',
                    data: Array.from({length: 20}, () => 0.5 + Math.random() * 0.5),
                    borderColor: '#00f3ff',
                    borderWidth: 1,
                    tension: 0.4,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { display: false },
                    y: { grid: { color: 'rgba(255,255,255,0.05)' } }
                },
                animation: false
            }
        });

        // Interactive Slider
        function updateChart(val) {
            document.getElementById('lr-val').innerText = val;
            // Simulate changing chart data based on LR
            const newData = lossChart.data.datasets[0].data.map(v => Math.max(0, v - (parseFloat(val) * 10) + Math.random()*0.1));
            lossChart.data.datasets[0].data = newData;
            lossChart.update();
            logToTerminal(`> UPDATING HYPERPARAMS: LR=${val}`);
        }

        // --- 4. TERMINAL LOGGING ---
        const terminal = document.getElementById('terminal-output');
        function logToTerminal(msg) {
            const div = document.createElement('div');
            div.innerHTML = `<span class="text-gray-500">${new Date().toLocaleTimeString()}</span> ${msg}`;
            div.className = "mb-1";
            terminal.appendChild(div);
            terminal.scrollTop = terminal.scrollHeight;
        }

        // Simulate activity
        setInterval(() => {
            const events = [
                "<span class='text-green-500'> > INGESTING BATCH [2048]</span>",
                "<span class='text-purple-400'> > OPTIMIZING GRADIENTS...</span>",
                "<span class='text-cyan'> > UPDATING WEIGHTS</span>"
            ];
            logToTerminal(events[Math.floor(Math.random() * events.length)]);
        }, 3000);

        // --- 5. DRAG & DROP ZONE ---
        const dropZone = document.getElementById('drop-zone');
        dropZone.addEventListener('click', () => {
            logToTerminal("<span class='text-yellow-400'> > UPLOAD STARTED: dataset_v2.parquet</span>");
            setTimeout(() => logToTerminal("<span class='text-green-500'> > UPLOAD COMPLETE (145MB)</span>"), 1500);
        });

    </script>
</body>
</html>


